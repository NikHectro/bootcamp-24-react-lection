"use strict";(self.webpackChunkbootcamp_24_react=self.webpackChunkbootcamp_24_react||[]).push([[652],{6652:function(t,e,n){n.r(e),n.d(e,{default:function(){return w}});var r=n(885),a=n(2791),s=n(2982),c=n(1413),o=n(1694),u=n.n(o),i=n(9085),l=n(4165),m=n(5861),d=n(4569),f={limit:4},p=n.n(d)().create({baseURL:"https://taupe-croissant-c4162a.netlify.app/api"}),h=function(){var t=(0,m.Z)((0,l.Z)().mark((function t(e,n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.post("/posts/".concat(e,"/comments"),n);case 2:return r=t.sent,a=r.data,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),b=function(){var t=(0,m.Z)((0,l.Z)().mark((function t(e){var n,r,a,s=arguments;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},t.next=3,p.get("/posts/".concat(e,"/comments"),{params:(0,c.Z)((0,c.Z)({},f),n)});case 3:return r=t.sent,a=r.data,t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(){var t=(0,m.Z)((0,l.Z)().mark((function t(e){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.delete("/comments/".concat(e)));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=n(184),g=function(t){var e=t.setComments,n=(0,a.useState)(!1),o=(0,r.Z)(n,2),l=o[0],m=o[1],d=(0,a.useState)(""),f=(0,r.Z)(d,2),p=f[0],b=f[1];return(0,v.jsxs)("form",{action:"#",className:"my-5",onSubmit:function(t){t.preventDefault(),p.trim()?(m(!0),h(10,{content:p}).then((function(t){i.Am.success("You have successfully created a new comment!"),e((function(e){return(0,c.Z)((0,c.Z)({},e),{},{data:[t].concat((0,s.Z)(e.data))})})),b("")})).catch((function(){i.Am.error("Something went wrong!")})).finally((function(){return m(!1)}))):i.Am.error("Fill all required fields!")},children:[(0,v.jsxs)("label",{className:"d-block form-label",children:[(0,v.jsx)("p",{children:"Post content"}),(0,v.jsx)("textarea",{rows:"5",value:p,onChange:function(t){return b(t.target.value)},className:"form-control",placeholder:"Write your feedback"})]}),(0,v.jsxs)("button",{type:"submit",className:u()("btn btn-primary my-2",l?"disabled":""),children:[l&&(0,v.jsx)("span",{className:"spinner-grow spinner-grow-sm mr-2"}),"Submit"]})]})},y=n(9353),j=function(t){var e,n=t.comments,s=t.setComments,o=(0,a.useState)(!0),u=(0,r.Z)(o,2),l=u[0],m=u[1],d=(0,a.useCallback)((function(){return b(10).then(s).catch((function(){i.Am.error("Something went wrong!")}))}),[10,s]);(0,a.useEffect)((function(){m(!0),d().finally((function(){return m(!1)}))}),[d]);return l?(0,v.jsx)("div",{className:"spinner-border text-primary",children:(0,v.jsx)("span",{className:"visually-hidden",children:"Loading..."})}):null!==n&&void 0!==n&&null!==(e=n.data)&&void 0!==e&&e.length?(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("ul",{className:"list-group",children:n.data.map((function(t){return(0,v.jsxs)("li",{className:"list-group-item list-group-item-action py-4",children:[(0,v.jsx)("div",{className:"d-flex w-100 justify-content-between",children:(0,v.jsx)("small",{children:(0,y.Z)(new Date(t.created_at),new Date,{addSuffix:!0})})}),(0,v.jsx)("div",{className:"mb-4 mt-3",dangerouslySetInnerHTML:{__html:t.content.replace(/\n/g,"<br/>")}}),(0,v.jsxs)("div",{className:"btn-group",children:[(0,v.jsx)("button",{type:"button",className:"btn btn-outline-danger",onClick:function(){return e=t.id,void x(e).then((function(){s((function(t){return(0,c.Z)((0,c.Z)({},t),{},{data:t.data.filter((function(t){return t.id!==e}))})})),i.Am.success("You have successfully deleted your comment!")})).catch((function(){i.Am.error("Something went wrong!")}));var e},children:"Delete comment"}),(0,v.jsx)("button",{type:"button",className:"btn btn-outline-primary",children:"Edit comment"})]})]},t.id)}))})}):(0,v.jsx)("p",{children:"No comments yet!"})},w=function(){var t=(0,a.useState)(null),e=(0,r.Z)(t,2),n=e[0],s=e[1];return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(g,{setComments:s}),(0,v.jsx)(j,{comments:n,setComments:s})]})}}}]);
//# sourceMappingURL=652.e29d041b.chunk.js.map